study_name: 'OptunaSearch_SR4_KFRN_Cnd1_model_structure'
persistent_sqlite_name: database_optuna.db
base_config_path: 'options/optuna/SR4_SwinIR_KFRN_Cnd1_template2.yml'

num_trials: 24
startup_trials: 8
optimization_direction: 'maximize' # 'maximize' for metrics, 'minimize' for loss.

metric_to_optimize:
  result_attribute: 'best_metric_results'
  metric_name: 'psnr'
  dataset_weights:
    Set14: 0.25
    Urban100: 0.85

pruner:
  watch_target_metric: 'psnr'
  watch_target_dataset: 'Set14'
  watch_since: 100000
  patience: 9


search_space:
  #
  # difficult_zone_estimator
  #
  - type: 'int'
    param_path: [ 'network_g', 'refinement_model', 'difficult_zone_estimator', 'num_block' ]
    args: { low: 3, high: 5 }
  #
  # kalman_gain_calculator
  #
  - type: 'categorical'
    param_path: [ 'network_g', 'refinement_model', 'kalman_gain_calculator', 'dz_amplify_method' ]
    args: {  choices: ['cubic', 'exp'] }
#  - type: 'int'
#    param_path: [ 'network_g', 'refinement_model', 'kalman_gain_calculator', 'dz_expand' ]
#    args: { low: 3, high: 4 }
#  - type: 'int'
#    param_path: [ 'network_g', 'refinement_model', 'kalman_gain_calculator', 'img_expand' ]
#    args: { low: 5, high: 6 }
  - type: 'float'
    param_path: [ 'network_g', 'refinement_model', 'kalman_gain_calculator', 'merge_expand' ]
    args: { low: 1.0, high: 2.0, step: 0.25 }
  - type: 'categorical'
    param_path: [ 'network_g', 'refinement_model', 'kalman_gain_calculator', 'activation_merge_conv_block' ]
    args: { choices: ['silu', 'sigmoid', 'tanh'] }
  #
  # kalman_predictor
  #
  - type: 'float'
    param_path: [ 'network_g', 'refinement_model', 'kalman_predictor', 'mamba_d_expand' ]
    args: { low: 1.8, high: 2.8, step: 0.2 }
  - type: 'int'
    param_path: [ 'network_g', 'refinement_model', 'kalman_predictor', 'cab_squeeze_factor' ]
    args: { low: 2, high: 8, step: 2 }
  - type: 'int'
    param_path: [ 'network_g', 'refinement_model', 'kalman_predictor', 'cab_compress_factor' ]
    args: { low: 2, high: 8, step: 2 }
  - param_path: [ 'network_g', 'refinement_model', 'kalman_predictor', 'final_activation' ]
    type: 'categorical'
    args: { choices: [ 'sigmoid', 'tanh' ] }